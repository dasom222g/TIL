### Context
n8n에서 LLM(대규모 언어 모델)을 통해 복잡한 JSON 데이터를 처리할 때, 프롬프트가 길어져 데이터 구조를 놓치는 문제가 발생했습니다. 이를 해결하기 위해 'Few-shot' 예시를 제공하는 방법도 있지만, 프롬프트를 간결하게 유지하며 데이터 처리를 안정적으로 하기 위해 먼저 정규표현식을 사용해 JSON을 1차로 정제한 후 LLM에 넘기는 접근법을 고려하게 되었습니다.

### Core
다음은 n8n에서 JSON 데이터를 정규표현식을 활용하여 정제하는 방법의 예시입니다.

```javascript
// n8n Code 노드에서 사용되는 JavaScript 예시
const jsonString = "{ \"name\": \"John\", \"age\": 30, \"city\": \"New York\" }";
const regex = /\{.*?\}/;
const matches = jsonString.match(regex);
let parsedJson;

if (matches && matches.length > 0) {
  parsedJson = JSON.parse(matches[0]);
} else {
  throw new Error('JSON 파싱에 실패했습니다.');
}

return parsedJson;
```

이 코드는 대규모 JSON 문자열에서 필요한 객체를 정규표현식으로 추출하고, 이를 JavaScript의 JSON.parse 메소드를 사용해 객체로 변환합니다.

### Insight
정규표현식을 사용하여 JSON 데이터를 1차적으로 정제한 후에 LLM에 전달하면, LLM이 보다 간결하고 명확한 데이터에 접근하게 되어 오류 가능성이 줄어듭니다. 이 방법을 통해 시스템의 안정성을 높이고, 불필요한 복잡성을 줄일 수 있습니다.

**출처:** [n8n Community Forum](https://community.n8n.io/)